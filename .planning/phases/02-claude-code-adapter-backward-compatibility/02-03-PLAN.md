---
phase: 02-claude-code-adapter-backward-compatibility
plan: 03
type: execute
wave: 2
depends_on: [02-01, 02-02]
files_modified:
  - commands/gsd/execute-phase.md
  - commands/gsd/help.md
  - commands/gsd/update.md
  - commands/gsd/new-project.md
  - commands/gsd/plan-phase.md
  - commands/gsd/verify-work.md
  - commands/gsd/map-codebase.md
  - commands/gsd/research-phase.md
  - commands/gsd/discuss-phase.md
  - commands/gsd/add-phase.md
  - commands/gsd/insert-phase.md
  - commands/gsd/remove-phase.md
  - commands/gsd/add-todo.md
  - commands/gsd/check-todos.md
  - commands/gsd/pause-work.md
  - commands/gsd/resume-work.md
  - commands/gsd/progress.md
  - commands/gsd/debug.md
  - commands/gsd/audit-milestone.md
  - commands/gsd/complete-milestone.md
  - commands/gsd/new-milestone.md
  - commands/gsd/plan-milestone-gaps.md
  - commands/gsd/list-phase-assumptions.md
  - commands/gsd/whats-new.md
autonomous: true

must_haves:
  truths:
    - Command source files use {{config_dir}} placeholders (not hardcoded paths)
    - After installation, command files have actual platform paths (no placeholders remain)
    - Installed commands reference correct paths for Claude Code (~/.claude/)
    - Commands execute without errors after path rendering
  artifacts:
    - path: commands/gsd/execute-phase.md
      provides: Platform-agnostic command using {{config_dir}}
      contains: "{{config_dir}}"
    - path: commands/gsd/help.md
      provides: Platform-agnostic help documentation
    - path: commands/gsd/update.md
      provides: Platform-aware update instructions
  key_links:
    - from: commands/gsd/*.md
      to: "{{config_dir}}/get-shit-done/"
      via: "@{{config_dir}}/get-shit-done/..."
      pattern: "{{config_dir}}"
---

<objective>
Make command files platform-agnostic by replacing hardcoded ~/.claude/ paths with {{config_dir}} placeholders that install.js renders during installation.

Purpose: Enable commands to work on any platform without modification, supporting future OpenCode integration while maintaining Claude Code backward compatibility.

Output: 24 command .md files using {{config_dir}} template syntax instead of hardcoded paths
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-claude-code-adapter-backward-compatibility/02-CONTEXT.md
@.planning/phases/02-claude-code-adapter-backward-compatibility/02-RESEARCH.md

# Template rendering pattern
Pattern from RESEARCH.md: Simple string.replace() during copyWithPathReplacement in install.js

# Command files to update
@commands/gsd/execute-phase.md
@commands/gsd/help.md
@commands/gsd/update.md
@commands/gsd/new-project.md
@commands/gsd/plan-phase.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update high-impact commands with path placeholders</name>
  <files>
    commands/gsd/execute-phase.md
    commands/gsd/new-project.md
    commands/gsd/plan-phase.md
    commands/gsd/verify-work.md
    commands/gsd/research-phase.md
  </files>
  <action>
Replace hardcoded ~/.claude/ paths with {{config_dir}} placeholders in execution context and workflow references:

**Pattern to replace:**
```
@~/.claude/get-shit-done/references/ui-brand.md
@~/.claude/get-shit-done/workflows/execute-phase.md
```

**Replace with:**
```
@{{config_dir}}/get-shit-done/references/ui-brand.md
@{{config_dir}}/get-shit-done/workflows/execute-phase.md
```

**Files to update:**

1. **execute-phase.md** (lines 25-26):
   - `@~/.claude/get-shit-done/references/ui-brand.md` → `@{{config_dir}}/get-shit-done/references/ui-brand.md`
   - `@~/.claude/get-shit-done/workflows/execute-phase.md` → `@{{config_dir}}/get-shit-done/workflows/execute-phase.md`

2. **new-project.md**:
   - Find all `@~/.claude/get-shit-done/` references
   - Replace with `@{{config_dir}}/get-shit-done/`

3. **plan-phase.md**:
   - `@~/.claude/get-shit-done/workflows/execute-plan.md` → `@{{config_dir}}/get-shit-done/workflows/execute-plan.md`
   - `@~/.claude/get-shit-done/templates/summary.md` → `@{{config_dir}}/get-shit-done/templates/summary.md`

4. **verify-work.md**:
   - All `@~/.claude/get-shit-done/workflows/` references

5. **research-phase.md**:
   - All `@~/.claude/get-shit-done/` references

**Verification pattern:**
After replacement, install.js copyWithPathReplacement will render:
- Claude Code: `{{config_dir}}` → `~/.claude/`
- OpenCode (Phase 3): `{{config_dir}}` → `~/.config/opencode/`

**DO NOT replace:**
- References to `.planning/` (project-local, platform-agnostic)
- References to `@.` (relative paths)
- User-facing documentation text mentioning "~/.claude/" as examples

**ONLY replace:**
- `@~/.claude/get-shit-done/` in execution_context sections
- Path references in workflow/reference loading
  </action>
  <verify>
```bash
# Verify placeholders exist
grep -l "{{config_dir}}" commands/gsd/execute-phase.md commands/gsd/new-project.md commands/gsd/plan-phase.md

# Verify no hardcoded paths remain in execution_context sections
! grep -A 5 "<execution_context>" commands/gsd/execute-phase.md | grep "@~/.claude/"

# Count replacements
grep -c "{{config_dir}}" commands/gsd/*.md
```
  </verify>
  <done>High-impact commands use {{config_dir}} placeholders, no ~/.claude/ in execution_context sections</done>
</task>

<task type="auto">
  <name>Task 2: Update documentation commands with platform-aware text</name>
  <files>
    commands/gsd/help.md
    commands/gsd/update.md
  </files>
  <action>
Update help and update commands to use platform-agnostic terminology:

**help.md updates:**

Find references to "Task tool" and make generic:
- "Claude Code-specific" → "platform-specific"
- "Task tool" → "parallel execution" (if referring to agent spawning)

**KEEP user-facing installation examples:**
```bash
npx get-shit-done-cc@latest
```
This is correct - it's the Claude Code package name.

**update.md updates:**

Current restart instruction (likely mentions "restart Claude Code"):
```
Restart Claude Code to load new commands
```

Make platform-aware:
```
Restart your AI platform to load new commands:
- Claude Code: Restart the application
- OpenCode: Commands reload automatically (or restart if needed)
```

**Alternative (simpler):**
```
Restart your AI platform to load the updated commands.
```

**DO NOT change:**
- Package names (get-shit-done-cc is Claude Code package)
- URLs, links to external docs
- Changelog content
- Version numbers

**ONLY change:**
- Generic platform references
- Restart instructions to be platform-neutral
- References to "Claude Code" when talking about GSD behavior (not installation)
  </action>
  <verify>
```bash
# Verify help.md has no inappropriate Task tool references in generic contexts
! grep -i "task tool" commands/gsd/help.md | grep -v "allowed-tools"

# Verify update.md has platform-neutral restart instructions
grep -i "restart" commands/gsd/update.md
```
  </verify>
  <done>Documentation commands use platform-neutral terminology while preserving Claude Code package specifics</done>
</task>

<task type="auto">
  <name>Task 3: Update remaining commands with path placeholders</name>
  <files>
    commands/gsd/map-codebase.md
    commands/gsd/discuss-phase.md
    commands/gsd/add-phase.md
    commands/gsd/insert-phase.md
    commands/gsd/remove-phase.md
    commands/gsd/add-todo.md
    commands/gsd/check-todos.md
    commands/gsd/pause-work.md
    commands/gsd/resume-work.md
    commands/gsd/progress.md
    commands/gsd/debug.md
    commands/gsd/audit-milestone.md
    commands/gsd/complete-milestone.md
    commands/gsd/new-milestone.md
    commands/gsd/plan-milestone-gaps.md
    commands/gsd/list-phase-assumptions.md
    commands/gsd/whats-new.md
  </files>
  <action>
Apply same pattern to remaining 17 command files:

**For each file:**
1. Find all `@~/.claude/get-shit-done/` references
2. Replace with `@{{config_dir}}/get-shit-done/`
3. Verify no other hardcoded platform paths

**Batch replacement command:**
```bash
cd commands/gsd

for file in *.md; do
  # Only replace @~/.claude/ in execution_context references
  sed -i '' 's|@~/.claude/get-shit-done/|@{{config_dir}}/get-shit-done/|g' "$file"
done
```

**Verification after batch:**
```bash
# Check all files have placeholders (or none if they don't reference get-shit-done)
grep -l "{{config_dir}}" commands/gsd/*.md

# Verify no hardcoded @~/.claude/get-shit-done/ remains
! grep "@~/.claude/get-shit-done/" commands/gsd/*.md
```

**Files that may not need changes:**
Some commands may not reference get-shit-done directory at all:
- progress.md (likely just reads .planning/)
- add-todo.md (likely just writes to STATE.md)
- check-todos.md (likely just reads STATE.md)

These are OK - only replace where hardcoded paths exist.

**Test one file manually first:**
1. Pick map-codebase.md
2. Read current content
3. Apply replacement
4. Verify diff makes sense
5. Then apply batch to remaining files
  </action>
  <verify>
```bash
# Verify no hardcoded get-shit-done paths remain
! grep "@~/.claude/get-shit-done/" commands/gsd/*.md

# Count files with placeholders (should be 15-20 files)
grep -l "{{config_dir}}" commands/gsd/*.md | wc -l

# Verify exact count matches expected files
ls commands/gsd/*.md | wc -l  # Total files (should be 24)
grep -l "{{config_dir}}" commands/gsd/*.md | wc -l  # Files with placeholders

# List all modified files for verification
git diff --name-only commands/gsd/*.md
```
  </verify>
  <done>All 24 command files use {{config_dir}} where applicable, no hardcoded ~/.claude/get-shit-done/ paths remain, file count verified</done>
</task>

</tasks>

<verification>
After all tasks complete:

```bash
# Verify no hardcoded paths in command files
! grep "@~/.claude/get-shit-done/" commands/gsd/*.md

# Count placeholder usage
echo "Files using {{config_dir}} placeholder:"
grep -l "{{config_dir}}" commands/gsd/*.md | wc -l

# Verify specific high-impact files
echo "execute-phase.md:"
grep "execution_context" -A 3 commands/gsd/execute-phase.md

echo "plan-phase.md:"
grep "execution_context" -A 3 commands/gsd/plan-phase.md

# Verify platform-neutral terminology in help
! grep -i "claude code" commands/gsd/help.md | grep -v "npx get-shit-done-cc"
```

**Important:** Commands in repository use {{config_dir}}. After installation via install.js, installed commands in ~/.claude/commands/gsd/ will have placeholders replaced with actual paths.
</verification>

<success_criteria>
- [ ] All @~/.claude/get-shit-done/ references replaced with @{{config_dir}}/get-shit-done/
- [ ] No hardcoded platform paths in command files
- [ ] help.md uses platform-neutral terminology
- [ ] update.md has platform-aware restart instructions
- [ ] Files compile/validate (no markdown syntax errors)
- [ ] Git diff shows only path replacements, no functional changes
- [ ] All 24 files verified with explicit count check
</success_criteria>

<output>
After completion, create `.planning/phases/02-claude-code-adapter-backward-compatibility/02-03-SUMMARY.md`
</output>
